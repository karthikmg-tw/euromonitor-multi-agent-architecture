# Neo4j v2 - Asia Pacific Knowledge Graph

**Version:** 2.0
**Author:** Winston (Architect Agent) + Karthikmg
**Date:** 2026-01-23
**Source Data:** Euromonitor Toys & Games in Asia Pacific (June 2024)

## Overview

This is a **redesigned version** of the Euromonitor Knowledge Graph incorporating:

- ✅ **11 Asia Pacific countries** (China, Japan, South Korea, India, Indonesia, Thailand, Malaysia, Philippines, Singapore, Taiwan, Hong Kong)
- ✅ **Complete category taxonomy** (28 categories across 4 levels)
- ✅ **10+ major companies and brands** (Tencent, NetEase, LEGO, Nintendo, Sony, etc.)
- ✅ **Market insights and trends** extracted from regional report
- ✅ **Comprehensive relationships** (geography, competitive, ownership, impact)

## Architecture

### Ontology Design

Follows the design principles from `docs/knowledge-graph-ontology-design.md`:

**Node Types:**
- `Geography` (Region, Country) - 12 nodes
- `Category` (Industry → Subcategories) - 28 nodes
- `Company` - 10 nodes
- `Brand` - 8 nodes
- `Insight` - 14 nodes
- `Trend` - 6 nodes

**Relationship Types:**
- `LOCATED_IN` (Country → Region)
- `BELONGS_TO` (Category hierarchy)
- `OWNED_BY` (Brand → Company)
- `COMPETES_IN` (Company → Category)
- `OPERATES_IN` (Company → Geography)
- `ASSOCIATED_WITH` (Brand → Category)
- `ABOUT_GEOGRAPHY` (Insight → Geography)
- `ABOUT_CATEGORY` (Insight → Category)
- `IMPACTS_GEOGRAPHY` (Trend → Geography)
- `IMPACTS_CATEGORY` (Trend → Category)
- `BENEFITS_COMPANY` (Trend → Company, positive/negative impact)

## File Structure

```
scripts/
├── python-v2/
│   └── extract_asia_pacific_data.py    # Python data extractor
│
└── neo4j-v2-asia-pacific/
    ├── README.md                        # This file
    ├── 01_schema_constraints.cypher     # Schema setup
    ├── 02_core_entities.cypher          # Geography & categories
    ├── 03_companies_brands.cypher       # Companies & brands
    ├── 04_insights_trends.cypher        # Insights & trends
    ├── load_all.sh                      # Bash loader script
    └── extracted_data.json              # Generated by Python script
```

## Quick Start

### Option 1: Load via Neo4j Browser (Recommended for First Time)

1. **Start Neo4j** (make sure it's running on `localhost:7474`)

2. **Open Neo4j Browser** at http://localhost:7474

3. **Load files in order** (copy-paste into query editor):
   ```cypher
   // Step 1: Schema
   // Copy contents of 01_schema_constraints.cypher and run

   // Step 2: Core Entities
   // Copy contents of 02_core_entities.cypher and run

   // Step 3: Companies & Brands
   // Copy contents of 03_companies_brands.cypher and run

   // Step 4: Insights & Trends
   // Copy contents of 04_insights_trends.cypher and run
   ```

4. **Verify the graph**:
   ```cypher
   // Count all nodes
   MATCH (n) RETURN labels(n) AS type, count(n) AS count
   ORDER BY count DESC;

   // Count all relationships
   MATCH ()-[r]->() RETURN type(r) AS relationship, count(r) AS count
   ORDER BY count DESC;

   // Visualize Asia Pacific structure
   MATCH path = (c:Country)-[:LOCATED_IN]->(r:Region)
   RETURN path LIMIT 25;
   ```

### Option 2: Load via Cypher-Shell (Command Line)

```bash
# Navigate to this directory
cd scripts/neo4j-v2-asia-pacific

# Load each file
cypher-shell -u neo4j -p your-password < 01_schema_constraints.cypher
cypher-shell -u neo4j -p your-password < 02_core_entities.cypher
cypher-shell -u neo4j -p your-password < 03_companies_brands.cypher
cypher-shell -u neo4j -p your-password < 04_insights_trends.cypher
```

### Option 3: Use the Loader Script

```bash
cd scripts/neo4j-v2-asia-pacific
chmod +x load_all.sh
./load_all.sh
```

## Python Data Extractor

The Python script `scripts/python-v2/extract_asia_pacific_data.py` extracts structured data from unstructured text reports.

### Usage:

```bash
cd scripts/python-v2
python3 extract_asia_pacific_data.py
```

### Output:
- Creates `scripts/neo4j-v2-asia-pacific/extracted_data.json`
- This JSON contains all extracted entities and can be used for validation or alternative loading methods

## Validation Queries

### Check Geography Structure
```cypher
// All countries in Asia Pacific
MATCH (c:Country)-[:LOCATED_IN]->(r:Region {name: 'Asia Pacific'})
RETURN c.name, c.iso_code, c.market_rank
ORDER BY c.market_rank;
```

### Check Category Hierarchy
```cypher
// Full category tree
MATCH (root:Category {level: 0})
OPTIONAL MATCH path = (root)<-[:BELONGS_TO*]-(child:Category)
RETURN root.name,
       child.name,
       child.level,
       length(path) as depth
ORDER BY depth, child.name;
```

### Check Companies and Their Focus
```cypher
// Companies with categories and geographies
MATCH (c:Company)-[:COMPETES_IN]->(cat:Category),
      (c)-[:OPERATES_IN]->(g:Country)
RETURN c.name,
       c.type,
       collect(DISTINCT cat.name) as categories,
       collect(DISTINCT g.name) as countries;
```

### Check Brand Ownership
```cypher
// Brands and their owners
MATCH (b:Brand)-[:OWNED_BY]->(c:Company)
RETURN b.name as brand, c.name as owner, b.type
ORDER BY c.name;
```

### Check Market Insights by Country
```cypher
// Insights for specific country
MATCH (i:Insight)-[:ABOUT_GEOGRAPHY]->(g:Country {name: 'China'})
RETURN i.type, i.insight, i.year
ORDER BY i.year DESC;
```

### Check Trends
```cypher
// All trends with their impact areas
MATCH (t:Trend)
OPTIONAL MATCH (t)-[:IMPACTS_GEOGRAPHY]->(g:Geography)
OPTIONAL MATCH (t)-[:IMPACTS_CATEGORY]->(c:Category)
RETURN t.trend_name,
       t.description,
       t.impact,
       collect(DISTINCT g.name) as geographies,
       collect(DISTINCT c.name) as categories;
```

### Check Trend Impact on Companies
```cypher
// Trends affecting companies (positive or negative)
MATCH (t:Trend)-[r:BENEFITS_COMPANY]->(c:Company)
RETURN t.trend_name,
       c.name,
       r.type as impact_type
ORDER BY t.trend_name;
```

## Key Insights Encoded

### Regional Insights
- Video games sales 3x higher than traditional toys in Asia Pacific
- Mobile gaming = 75% of video games sales
- E-commerce dominant channel (90% for video games, 35% for traditional toys)

### Country-Specific Insights

**China:**
- Strong rebound in 2023 post-COVID
- Growing preference for culturally-themed toys
- Mobile games >70% of video games
- Local brands (Sembo, Enlighten) gaining on LEGO

**Japan:**
- Trading card games (Pokémon) driving growth
- Games & puzzles biggest traditional category
- Kidults important segment

**South Korea:**
- Low birth rate driving kidults focus
- Gender-neutral toys trend
- Market decline 2022-2023 but returning to growth

**India:**
- High growth potential
- E-sports popularity boosting video games
- Rising smartphone penetration

### Market Trends
1. **Kidults** - Adults as key target (declining birth rates)
2. **Cultural Identity** - Locally-themed toys (China)
3. **Gender-Neutral Toys** - Blurring boys/girls distinction
4. **Experiential Retail** - Offline stores creating experiences
5. **Cross-Platform Gaming** - Mobile expanding to console/PC
6. **E-Sports** - Competitive gaming rise (India focus)

## Data Lineage

**Source Documents:**
- `docs/data-samples/Toys_and_Games_in_Asia_Pacific.txt` (Regional report, June 2024)
- `docs/data-samples/toys_and_games_india_semantic.txt` (Category taxonomy)

**Extraction:** `scripts/python-v2/extract_asia_pacific_data.py`

**Loading:** This directory's `.cypher` files

## Differences from v1

| Aspect | v1 (scripts/neo4j/) | v2 (scripts/neo4j-v2-asia-pacific/) |
|--------|---------------------|-------------------------------------|
| **Countries** | Partial (China, Japan, Korea, India) | Complete 11 APAC countries |
| **Categories** | 6 categories | 28 categories (full taxonomy) |
| **Companies** | Basic top players | 10 companies with detailed info |
| **Insights** | Embedded in properties | Separate `Insight` nodes |
| **Trends** | Not modeled | 6 `Trend` nodes with relationships |
| **Ontology** | Ad-hoc | Follows design doc principles |
| **Data Source** | Mixed | Clean extraction from reports |

## Next Steps

After loading this graph, you can:

1. **Validate the ontology** against your original design document
2. **Run the validation queries** from `docs/knowledge-graph-ontology-design.md`
3. **Add market data metrics** (Phase 2) - market sizes, shares, forecasts
4. **Add unstructured content** (Phase 3) - full report texts with vector embeddings
5. **Add citation sources** (Phase 4) - source nodes with provenance tracking

## Troubleshooting

**"Constraint already exists" errors:**
- Comment out constraints in `01_schema_constraints.cypher` if reloading
- Or use the DROP commands at the top of that file

**"Node already exists" errors:**
- The scripts use `MERGE` so they're idempotent
- Re-running should be safe but may create duplicates if IDs changed
- For clean reload: `MATCH (n) DETACH DELETE n;` (⚠️ deletes everything!)

**Neo4j not accessible:**
- Check if Neo4j is running: `neo4j status`
- Default connection: `bolt://localhost:7687`
- Default web UI: `http://localhost:7474`

## Contact

For questions about this ontology or loading process, contact the architect team or refer to:
- `docs/knowledge-graph-ontology-design.md` (full design document)
- `docs/ontology-visualization.md` (visual representations)

---

**Last Updated:** 2026-01-23
**Graph Version:** 2.0
**Status:** Ready for loading and validation
